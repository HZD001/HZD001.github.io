<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>下班倒计时</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="card">
        <div class="header">
          <h1>下班倒计时</h1>
          <button class="settings-btn" id="settingsBtn">⚙️ 设置</button>
        </div>

        <div class="timer-display" id="timerDisplay">
          <div class="time">00:00:00</div>
          <div class="status" id="status">点击开始按钮上班打卡</div>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="controls">
          <button class="btn btn-primary" id="startBtn">开始上班</button>
          <button class="btn btn-secondary" id="resetBtn">重置</button>
        </div>

        <div class="info" id="info">
          <div class="info-item">
            <span>上班时间：</span>
            <span id="startTime">--:--</span>
          </div>
          <div class="info-item">
            <span>预计下班：</span>
            <span id="endTime">--:--</span>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="settingsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>设置</h2>
          <button class="close-btn" id="closeBtn">×</button>
        </div>

        <div class="modal-body">
          <div class="form-group">
            <label for="startWorkTime">今日上班时间</label>
            <input type="time" id="startWorkTime" value="" />
            <div style="margin-top: 8px; color: #666; font-size: 14px;">
              留空则使用点击"开始上班"时的实际时间
            </div>
          </div>

          <div class="form-group">
            <label for="workHours">每日工作时长（小时）</label>
            <input
              type="number"
              id="workHours"
              min="1"
              max="12"
              step="0.5"
              value="8"
            />
          </div>

          <div class="form-group">
            <label for="lunchBreak">午休时长（分钟）</label>
            <input
              type="number"
              id="lunchBreak"
              min="0"
              max="180"
              step="15"
              value="60"
            />
            <div style="margin-top: 8px; color: #666; font-size: 14px;">
              午休时间不计入工作时长，会额外增加到总时长中
            </div>
          </div>

          <div class="form-group">
            <label for="lunchTime">午休开始时间</label>
            <input type="time" id="lunchTime" value="12:00" />
          </div>

          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" id="enableLunchNotify" checked />
              <span>启用午休提醒</span>
            </label>
          </div>

          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" id="enableOffWorkNotify" checked />
              <span>启用下班提醒</span>
            </label>
          </div>

          <div class="form-group">
            <label for="notifyMethod">提醒方式</label>
            <select id="notifyMethod">
              <option value="all">全部提醒（桌面通知+声音+闪烁）</option>
              <option value="notification">仅桌面通知</option>
              <option value="sound">仅声音提示</option>
              <option value="flash">仅页面闪烁</option>
              <option value="vibrate">震动提醒（移动端）</option>
            </select>
          </div>

          <div class="form-group">
            <label for="soundType">提示音类型</label>
            <select id="soundType">
              <option value="beep">默认提示音</option>
              <option value="bell">铃声</option>
              <option value="chime">钟声</option>
              <option value="ding">叮咚</option>
              <option value="custom">自定义音频</option>
            </select>
          </div>

          <div class="form-group" id="customSoundGroup" style="display: none;">
            <label for="customSound">自定义音频文件 (MP3/WAV)</label>
            <input type="file" id="customSound" accept="audio/mp3,audio/wav,audio/ogg" />
            <div id="customSoundPreview" style="margin-top: 10px; color: #666; font-size: 14px;"></div>
          </div>

          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" id="enableBreakReminder" />
              <span>启用定时休息提醒</span>
            </label>
          </div>

          <div class="form-group">
            <label for="breakInterval">休息提醒间隔（分钟）</label>
            <input
              type="number"
              id="breakInterval"
              min="15"
              max="120"
              step="5"
              value="60"
            />
            <div style="margin-top: 8px; color: #666; font-size: 14px;">
              每隔多长时间提醒休息一次
            </div>
          </div>

          <div class="form-group">
            <label for="breakDuration">建议休息时长（分钟）</label>
            <input
              type="number"
              id="breakDuration"
              min="1"
              max="30"
              step="1"
              value="5"
            />
            <div style="margin-top: 8px; color: #666; font-size: 14px;">
              建议每次休息的时长
            </div>
          </div>

          <div class="form-group" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
            <label style="margin-bottom: 15px;">测试提醒功能</label>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary" id="testLunchBtn" type="button" style="flex: 1; padding: 10px;">
                测试午休提醒
              </button>
              <button class="btn btn-secondary" id="testOffWorkBtn" type="button" style="flex: 1; padding: 10px;">
                测试下班提醒
              </button>
            </div>
            <div style="margin-top: 10px;">
              <button class="btn btn-secondary" id="testBreakBtn" type="button" style="width: 100%; padding: 10px;">
                测试休息提醒
              </button>
            </div>
            <div style="margin-top: 15px;">
              <button class="btn btn-secondary" id="checkPermissionBtn" type="button" style="width: 100%; padding: 10px;">
                检查通知权限状态
              </button>
            </div>
            <div id="permissionStatus" style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px; font-size: 14px; display: none;">
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancelBtn">取消</button>
          <button class="btn btn-primary" id="saveBtn">保存</button>
        </div>
      </div>
    </div>

    <div class="modal" id="breakModal">
      <div class="modal-content break-modal">
        <div class="modal-header">
          <h2>😊 休息时间到啦</h2>
        </div>

        <div class="modal-body" style="text-align: center; padding: 40px 30px;">
          <div style="font-size: 16px; color: #666; margin-bottom: 30px;">
            已经工作一段时间了，起来走走、看看远方<br>
            放松一下眼睛和身体吧~
          </div>
          
          <div style="font-size: 48px; font-weight: bold; color: #667eea; margin: 20px 0;" id="breakTimer">
            05:00
          </div>
          
          <div style="font-size: 14px; color: #999; margin-bottom: 30px;">
            建议休息时长
          </div>

          <div style="display: flex; gap: 15px; justify-content: center;">
            <button class="btn btn-secondary" id="skipBreakBtn">跳过休息</button>
            <button class="btn btn-primary" id="startBreakBtn">开始休息</button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/config.js"></script>
    <script src="js/notification.js"></script>
    <script src="js/timer.js"></script>
  </body>
</html>
